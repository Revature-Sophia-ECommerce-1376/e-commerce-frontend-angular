{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/app.component\";\nimport * as i2 from \"src/app/services/product.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@auth0/auth0-angular\";\nimport * as i5 from \"./../../pages/display-products/display-products.component\";\nimport * as i6 from \"src/app/services/authentication.service\";\nimport * as i7 from \"@angular/common\";\n\nfunction ProductCardComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 9)(2, \"span\", 16);\n    i0.ɵɵtext(3, \"Quantity Ordered\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(4, \"input\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"qty\", ctx_r0.productInfo.id, \"\");\n    i0.ɵɵproperty(\"value\", 1);\n  }\n}\n\nfunction ProductCardComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"div\", 19)(2, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function ProductCardComponent_div_20_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.updatePopUp(ctx_r3.productInfo));\n    });\n    i0.ɵɵtext(3, \" Update Item Info \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function ProductCardComponent_div_20_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.deletePopUp(ctx_r5.productInfo));\n    });\n    i0.ɵɵtext(5, \" Delete Product \");\n    i0.ɵɵelementEnd()()();\n  }\n}\n\nfunction ProductCardComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function ProductCardComponent_div_23_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.addToCart(ctx_r6.productInfo));\n    });\n    i0.ɵɵtext(2, \" Add to Cart \");\n    i0.ɵɵelementEnd()();\n  }\n}\n/**\n * Create a product card for each product.\n * Also contains functions to add product to cart\n */\n\n\nexport class ProductCardComponent {\n  constructor(appcomponent, productService, router, authService, disProdComp, authentication) {\n    this.appcomponent = appcomponent;\n    this.productService = productService;\n    this.router = router;\n    this.authService = authService;\n    this.disProdComp = disProdComp;\n    this.authentication = authentication;\n    this.currentUserString = sessionStorage.getItem('user');\n    this.currentUser = JSON.parse(this.currentUserString);\n    this.wantToDelete = false;\n    this.wantToUpdate = false; // array of products\n\n    this.products = [];\n    this.totalPrice = 0;\n    this.msg = '';\n    this.modalVisibility = '';\n    this.role = this.authentication.role;\n  }\n\n  ngOnInit() {\n    this.subscription = this.productService.getCart().subscribe(cart => {\n      this.cartCount = cart.cartCount;\n      this.products = cart.products;\n      this.totalPrice = cart.totalPrice;\n    });\n  }\n  /**\n   * Adds Product to cart\n   * @param {Product} product\n   * @returns void\n   */\n\n\n  addToCart(product) {\n    let inCart = false;\n    let toBuy = Number(document.getElementById(`qty${product.id}`).value);\n    this.msg = '';\n\n    if (toBuy < 1) {\n      this.msg = 'Can not add a 0 or negitive number of items to order, please enter a higher order amount.';\n      return;\n    }\n\n    this.products.forEach(element => {\n      if (element.product.id == product.id) {\n        if (toBuy + element.quantity > product.quantity) {\n          this.msg = 'Can not order more items then currently in stock, please enter a lower order amount.';\n          inCart = true;\n        } else {\n          element.quantity += toBuy;\n          let cart = {\n            cartCount: this.cartCount + toBuy,\n            products: this.products,\n            totalPrice: this.totalPrice + toBuy * this.productInfo.price\n          };\n          this.productService.setCart(cart);\n          inCart = true;\n          return;\n        }\n      }\n    });\n\n    if (!inCart) {\n      if (toBuy > product.quantity) {\n        this.msg = 'Can not order more items then currently in stock, please enter a lower order amount';\n        return;\n      }\n\n      let newProduct = {\n        product: product,\n        quantity: toBuy\n      };\n      this.products.push(newProduct);\n      let cart = {\n        cartCount: this.cartCount + toBuy,\n        products: this.products,\n        totalPrice: this.totalPrice + product.price * toBuy\n      };\n      this.productService.setCart(cart);\n    }\n  }\n  /**\n   * Sets Product in Session storage. Redirects user to /product-details\n   */\n\n\n  selectProduct() {\n    sessionStorage.setItem('selectedProductId', this.productInfo.id.toString());\n    this.router.navigate(['/product-details']);\n  }\n\n  ngOnDestroy() {\n    this.subscription.unsubscribe();\n  }\n  /**\n   * Updates popup with\n   * @param {Product} product\n  */\n\n\n  updatePopUp(product) {\n    this.disProdComp.productToUpdate.id = product.id;\n    this.disProdComp.productToUpdate.name = product.name;\n    this.disProdComp.productToUpdate.quantity = product.quantity;\n    this.disProdComp.productToUpdate.price = product.price;\n    this.disProdComp.productToUpdate.image = product.image;\n    this.disProdComp.productToUpdate.description = product.description;\n    this.disProdComp.updateModalVisibility = 'block';\n  }\n  /**\n   * Removes Popup\n   * @param product\n   */\n\n\n  deletePopUp(product) {\n    this.disProdComp.productToDelete.id = product.id;\n    this.disProdComp.deleteModalVisibility = 'block';\n  }\n\n  wantsToDelete() {\n    this.wantToDelete = !this.wantToDelete;\n  }\n  /**\n   * Removes Product and reroutes to /\n   * @param product\n   */\n\n\n  onDeleteProduct(product) {\n    this.productService.deleteProduct(product.id).subscribe(() => {\n      this.router.routeReuseStrategy.shouldReuseRoute = () => false;\n\n      this.router.onSameUrlNavigation = 'reload';\n      this.router.navigate(['/']);\n    }, err => console.log(err));\n  }\n\n}\n\nProductCardComponent.ɵfac = function ProductCardComponent_Factory(t) {\n  return new (t || ProductCardComponent)(i0.ɵɵdirectiveInject(i1.AppComponent), i0.ɵɵdirectiveInject(i2.ProductService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.AuthService), i0.ɵɵdirectiveInject(i5.DisplayProductsComponent), i0.ɵɵdirectiveInject(i6.AuthenticationService));\n};\n\nProductCardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ProductCardComponent,\n  selectors: [[\"app-product-card\"]],\n  inputs: {\n    productInfo: \"productInfo\"\n  },\n  decls: 25,\n  vars: 13,\n  consts: [[1, \"card\", 2, \"width\", \"18rem\"], [\"alt\", \"Card image cap\", 1, \"card-img-top\", 2, \"cursor\", \"pointer\", 3, \"src\", \"click\"], [1, \"card-body\", 2, \"cursor\", \"pointer\", 3, \"click\"], [1, \"card-title\"], [1, \"well\"], [1, \"card-text\"], [1, \"card-text\", \"text-danger\"], [1, \"container\"], [1, \"input-group\", \"input-group-sm\", \"mb-3\"], [1, \"input-group-prepend\"], [\"id\", \"inputGroup-sizing-sm\", 1, \"input-group-text\"], [\"type\", \"number\", \"aria-label\", \"Sizing example input\", \"aria-describedby\", \"inputGroup-sizing-sm\", \"disabled\", \"\", 1, \"form-control\", 3, \"value\"], [\"class\", \"input-group input-group-sm mb-3\", 4, \"ngIf\"], [\"class\", \"wrapper text-center\", 4, \"ngIf\"], [1, \"card-body\"], [4, \"ngIf\"], [1, \"input-group-text\"], [\"type\", \"number\", \"aria-label\", \"Sizing example input\", \"aria-describedby\", \"inputGroup-sizing-sm\", \"min\", \"1\", 1, \"form-control\", 3, \"id\", \"value\"], [1, \"wrapper\", \"text-center\"], [1, \"card-body\", \"btn-group\", \"text-center\"], [1, \"btn\", \"btn-outline-primary\", \"btn-sm\", 3, \"click\"], [1, \"btn\", \"btn-outline-danger\", \"btn-sm\", 3, \"click\"], [1, \"btn\", \"btn-outline-success\", \"btn-block\", \"text-center\", 3, \"click\"]],\n  template: function ProductCardComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"img\", 1);\n      i0.ɵɵlistener(\"click\", function ProductCardComponent_Template_img_click_1_listener() {\n        return ctx.selectProduct();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"div\", 2);\n      i0.ɵɵlistener(\"click\", function ProductCardComponent_Template_div_click_2_listener() {\n        return ctx.selectProduct();\n      });\n      i0.ɵɵelementStart(3, \"h5\", 3);\n      i0.ɵɵtext(4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 4)(6, \"p\", 5);\n      i0.ɵɵtext(7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"h5\", 5);\n      i0.ɵɵtext(9);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"p\", 6);\n      i0.ɵɵtext(11);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"div\", 7)(13, \"div\", 8)(14, \"div\", 9)(15, \"span\", 10);\n      i0.ɵɵtext(16, \"Quantity in Stock\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(17, \"input\", 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(18, ProductCardComponent_div_18_Template, 5, 2, \"div\", 12);\n      i0.ɵɵpipe(19, \"async\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(20, ProductCardComponent_div_20_Template, 6, 0, \"div\", 13);\n      i0.ɵɵelementStart(21, \"div\", 14)(22, \"div\", 7);\n      i0.ɵɵtemplate(23, ProductCardComponent_div_23_Template, 3, 0, \"div\", 15);\n      i0.ɵɵpipe(24, \"async\");\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"src\", ctx.productInfo.image, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(ctx.productInfo.name);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(ctx.productInfo.description);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"$\", ctx.productInfo.price.toFixed(2), \"\");\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.msg);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"value\", ctx.productInfo.quantity);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(19, 9, ctx.authService.isAuthenticated$));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.role == \"ADMIN\");\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(24, 11, ctx.authService.isAuthenticated$));\n    }\n  },\n  dependencies: [i7.NgIf, i7.AsyncPipe],\n  styles: [\".card[_ngcontent-%COMP%] {\\n  size: auto;\\n  min-width: 275px;\\n  max-width: 200px;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  transition: .2s ease-out;\\n}\\n\\n.deleteoption[_ngcontent-%COMP%] {\\n  text-align: center;\\n}\\n\\nimg[_ngcontent-%COMP%]\\n{\\n  justify-content: center;\\n  height: auto;\\n  width: auto;\\n  max-height: 200px;\\n  max-width: 307px;\\n  left:0;\\n}\\n\\ndiv[_ngcontent-%COMP%] {\\n  position: relative;\\n  transition: .2s ease-out;\\n}\\n\\n.card[_ngcontent-%COMP%]:hover{\\n  box-shadow: 0 5px 10px rgba(0,0,0,.2);\\n  transform: translate3d(0,-10px,0);\\n}\\n\\n.modal-title[_ngcontent-%COMP%]{\\n  text-align: center;\\n  -webkit-text-decoration: underline #F26925;\\n          text-decoration: underline #F26925;\\n  font-weight: bold;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2R1Y3QtY2FyZC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsVUFBVTtFQUNWLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsd0JBQW1CO0VBQW5CLG1CQUFtQjtFQUNuQix3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7O0VBRUUsdUJBQXVCO0VBQ3ZCLFlBQVk7RUFDWixXQUFXO0VBQ1gsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixNQUFNO0FBQ1I7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsd0JBQXdCO0FBQzFCOztBQUVBO0VBQ0UscUNBQXFDO0VBQ3JDLGlDQUFpQztBQUNuQzs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQiwwQ0FBa0M7VUFBbEMsa0NBQWtDO0VBQ2xDLGlCQUFpQjtBQUNuQiIsImZpbGUiOiJwcm9kdWN0LWNhcmQuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5jYXJkIHtcbiAgc2l6ZTogYXV0bztcbiAgbWluLXdpZHRoOiAyNzVweDtcbiAgbWF4LXdpZHRoOiAyMDBweDtcbiAgaGVpZ2h0OiBmaXQtY29udGVudDtcbiAgdHJhbnNpdGlvbjogLjJzIGVhc2Utb3V0O1xufVxuXG4uZGVsZXRlb3B0aW9uIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG5pbWdcbntcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGhlaWdodDogYXV0bztcbiAgd2lkdGg6IGF1dG87XG4gIG1heC1oZWlnaHQ6IDIwMHB4O1xuICBtYXgtd2lkdGg6IDMwN3B4O1xuICBsZWZ0OjA7XG59XG5cbmRpdiB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdHJhbnNpdGlvbjogLjJzIGVhc2Utb3V0O1xufVxuXG4uY2FyZDpob3ZlcntcbiAgYm94LXNoYWRvdzogMCA1cHggMTBweCByZ2JhKDAsMCwwLC4yKTtcbiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUzZCgwLC0xMHB4LDApO1xufVxuXG4ubW9kYWwtdGl0bGV7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmUgI0YyNjkyNTtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG59Il19 */\"]\n});","map":{"version":3,"mappings":";;;;;;;;;;;IAsBIA,+BAA0F,CAA1F,EAA0F,KAA1F,EAA0F,CAA1F,EAA0F,CAA1F,EAA0F,MAA1F,EAA0F,EAA1F;IAEmCA;IAAgBA;IAEjDA;IAEFA;;;;;IAFSA;IAAAA;IAC2CA;;;;;;;;IAKtDA,gCAAyD,CAAzD,EAAyD,KAAzD,EAAyD,EAAzD,EAAyD,CAAzD,EAAyD,QAAzD,EAAyD,EAAzD;IAGmDA;MAAAA;MAAA;MAAA,OAASA,sDAAT;IAAiC,CAAjC;IAC7CA;IACFA;IACAA;IAA8CA;MAAAA;MAAA;MAAA,OAASA,sDAAT;IAAiC,CAAjC;IAC5CA;IACFA;;;;;;;;IAQAA,4BAAkD,CAAlD,EAAkD,QAAlD,EAAkD,EAAlD;IACgEA;MAAAA;MAAA;MAAA,OAASA,oDAAT;IAA+B,CAA/B;IAC5DA;IACFA;;;ACjCR;;;;;;AAIA,OAAM,MAAOC,oBAAP,CAA2B;EAyB/BC,YACSC,YADT,EAEUC,cAFV,EAGUC,MAHV,EAKSC,WALT,EAMSC,WANT,EAOUC,cAPV,EAO+C;IANtC;IACC;IACA;IAED;IACA;IACC;IA/BV,yBAAyBC,cAAc,CAACC,OAAf,CAAuB,MAAvB,CAAzB;IACA,mBAAoBC,IAAI,CAACC,KAAL,CAAW,KAAKC,iBAAhB,CAApB;IAGA,oBAAwB,KAAxB;IACA,oBAAwB,KAAxB,CA0B+C,CAvB/C;;IACA,gBAGM,EAHN;IAMA,kBAAqB,CAArB;IACA,WAAc,EAAd;IAEA,uBAA0B,EAA1B;IACA,YAAe,KAAKL,cAAL,CAAoBM,IAAnC;EAeK;;EACLC,QAAQ;IACN,KAAKC,YAAL,GAAoB,KAAKZ,cAAL,CAAoBa,OAApB,GAA8BC,SAA9B,CAAyCC,IAAD,IAAS;MACnE,KAAKC,SAAL,GAAiBD,IAAI,CAACC,SAAtB;MACA,KAAKC,QAAL,GAAgBF,IAAI,CAACE,QAArB;MACA,KAAKC,UAAL,GAAkBH,IAAI,CAACG,UAAvB;IACD,CAJmB,CAApB;EAKD;EAED;;;;;;;EAKAC,SAAS,CAACC,OAAD,EAAiB;IACxB,IAAIC,MAAM,GAAG,KAAb;IACA,IAAIC,KAAK,GAAGC,MAAM,CACGC,QAAQ,CAACC,cAAT,CAAwB,MAAML,OAAO,CAACM,EAAE,EAAxC,EAA6CC,KADhD,CAAlB;IAGA,KAAKC,GAAL,GAAW,EAAX;;IAEA,IAAIN,KAAK,GAAG,CAAZ,EAAe;MACb,KAAKM,GAAL,GACE,2FADF;MAEA;IACD;;IAED,KAAKX,QAAL,CAAcY,OAAd,CAAuBC,OAAD,IAAY;MAChC,IAAIA,OAAO,CAACV,OAAR,CAAgBM,EAAhB,IAAsBN,OAAO,CAACM,EAAlC,EAAsC;QACpC,IAAIJ,KAAK,GAAGQ,OAAO,CAACC,QAAhB,GAA2BX,OAAO,CAACW,QAAvC,EAAiD;UAC/C,KAAKH,GAAL,GACE,sFADF;UAEAP,MAAM,GAAG,IAAT;QACD,CAJD,MAKK;UACHS,OAAO,CAACC,QAAR,IAAoBT,KAApB;UACA,IAAIP,IAAI,GAAG;YACTC,SAAS,EAAE,KAAKA,SAAL,GAAiBM,KADnB;YAETL,QAAQ,EAAE,KAAKA,QAFN;YAGTC,UAAU,EAAE,KAAKA,UAAL,GAAmBI,KAAK,GAAG,KAAKU,WAAL,CAAiBC;UAH/C,CAAX;UAMA,KAAKjC,cAAL,CAAoBkC,OAApB,CAA4BnB,IAA5B;UACAM,MAAM,GAAG,IAAT;UACA;QACD;MACF;IACF,CApBD;;IAsBA,IAAI,CAACA,MAAL,EAAa;MACX,IAAIC,KAAK,GAAGF,OAAO,CAACW,QAApB,EAA8B;QAC5B,KAAKH,GAAL,GACE,qFADF;QAEA;MACD;;MAED,IAAIO,UAAU,GAAG;QACff,OAAO,EAAEA,OADM;QAEfW,QAAQ,EAAET;MAFK,CAAjB;MAIA,KAAKL,QAAL,CAAcmB,IAAd,CAAmBD,UAAnB;MACA,IAAIpB,IAAI,GAAG;QACTC,SAAS,EAAE,KAAKA,SAAL,GAAiBM,KADnB;QAETL,QAAQ,EAAE,KAAKA,QAFN;QAGTC,UAAU,EAAE,KAAKA,UAAL,GAAkBE,OAAO,CAACa,KAAR,GAAgBX;MAHrC,CAAX;MAKA,KAAKtB,cAAL,CAAoBkC,OAApB,CAA4BnB,IAA5B;IACD;EACF;EAED;;;;;EAGAsB,aAAa;IACXhC,cAAc,CAACiC,OAAf,CAAuB,mBAAvB,EAA4C,KAAKN,WAAL,CAAiBN,EAAjB,CAAoBa,QAApB,EAA5C;IACA,KAAKtC,MAAL,CAAYuC,QAAZ,CAAqB,CAAC,kBAAD,CAArB;EACD;;EAEDC,WAAW;IACT,KAAK7B,YAAL,CAAkB8B,WAAlB;EACD;EAED;;;;;;EAIAC,WAAW,CAACvB,OAAD,EAAiB;IAC1B,KAAKjB,WAAL,CAAiByC,eAAjB,CAAiClB,EAAjC,GAAsCN,OAAO,CAACM,EAA9C;IACA,KAAKvB,WAAL,CAAiByC,eAAjB,CAAiCC,IAAjC,GAAwCzB,OAAO,CAACyB,IAAhD;IACA,KAAK1C,WAAL,CAAiByC,eAAjB,CAAiCb,QAAjC,GAA4CX,OAAO,CAACW,QAApD;IACA,KAAK5B,WAAL,CAAiByC,eAAjB,CAAiCX,KAAjC,GAAyCb,OAAO,CAACa,KAAjD;IACA,KAAK9B,WAAL,CAAiByC,eAAjB,CAAiCE,KAAjC,GAAyC1B,OAAO,CAAC0B,KAAjD;IACA,KAAK3C,WAAL,CAAiByC,eAAjB,CAAiCG,WAAjC,GAA+C3B,OAAO,CAAC2B,WAAvD;IACA,KAAK5C,WAAL,CAAiB6C,qBAAjB,GAAyC,OAAzC;EACD;EAED;;;;;;EAIAC,WAAW,CAAC7B,OAAD,EAAiB;IAC1B,KAAKjB,WAAL,CAAiB+C,eAAjB,CAAiCxB,EAAjC,GAAsCN,OAAO,CAACM,EAA9C;IACA,KAAKvB,WAAL,CAAiBgD,qBAAjB,GAAyC,OAAzC;EACD;;EACDC,aAAa;IACX,KAAKC,YAAL,GAAoB,CAAC,KAAKA,YAA1B;EACD;EAED;;;;;;EAIAC,eAAe,CAAClC,OAAD,EAAiB;IAC9B,KAAKpB,cAAL,CAAoBuD,aAApB,CAAkCnC,OAAO,CAACM,EAA1C,EAA8CZ,SAA9C,CACE,MAAK;MACH,KAAKb,MAAL,CAAYuD,kBAAZ,CAA+BC,gBAA/B,GAAkD,MAAM,KAAxD;;MACA,KAAKxD,MAAL,CAAYyD,mBAAZ,GAAkC,QAAlC;MAEA,KAAKzD,MAAL,CAAYuC,QAAZ,CAAqB,CAAC,GAAD,CAArB;IACD,CANH,EAOGmB,GAAD,IAAcC,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAPhB;EASD;;AA7J8B;;;mBAApB9D,sBAAoBD;AAAA;;;QAApBC;EAAoBiE;EAAAC;IAAA/B;EAAA;EAAAgC;EAAAC;EAAAC;EAAAC;IAAA;MDtBjCvE,+BAAuC,CAAvC,EAAuC,KAAvC,EAAuC,CAAvC;MAC+EA;QAAA,OAASwE,mBAAT;MAAwB,CAAxB;MAA7ExE;MAEAA;MAAgDA;QAAA,OAASwE,mBAAT;MAAwB,CAAxB;MAC9CxE;MAAuBA;MAAsBA;MAC7CA,+BAAkB,CAAlB,EAAkB,GAAlB,EAAkB,CAAlB;MACwBA;MAA6BA;MACnDA;MAAsBA;MAAmCA;MAG3DA;MAAiCA;MAASA;MAG5CA,gCAAuB,EAAvB,EAAuB,KAAvB,EAAuB,CAAvB,EAAuB,EAAvB,EAAuB,KAAvB,EAAuB,CAAvB,EAAuB,EAAvB,EAAuB,MAAvB,EAAuB,EAAvB;MAI+DA;MAAiBA;MAE5EA;MAEFA;MACAA;;MAOFA;MAGAA;MAcAA,iCAAuB,EAAvB,EAAuB,KAAvB,EAAuB,CAAvB;MAEIA;;MAKFA;;;;MApDiDA;MAAAA;MAG1BA;MAAAA;MAECA;MAAAA;MACAA;MAAAA;MAGSA;MAAAA;MAS6CA;MAAAA;MAGhCA;MAAAA;MAU1CA;MAAAA;MAgBIA;MAAAA","names":["i0","ProductCardComponent","constructor","appcomponent","productService","router","authService","disProdComp","authentication","sessionStorage","getItem","JSON","parse","currentUserString","role","ngOnInit","subscription","getCart","subscribe","cart","cartCount","products","totalPrice","addToCart","product","inCart","toBuy","Number","document","getElementById","id","value","msg","forEach","element","quantity","productInfo","price","setCart","newProduct","push","selectProduct","setItem","toString","navigate","ngOnDestroy","unsubscribe","updatePopUp","productToUpdate","name","image","description","updateModalVisibility","deletePopUp","productToDelete","deleteModalVisibility","wantsToDelete","wantToDelete","onDeleteProduct","deleteProduct","routeReuseStrategy","shouldReuseRoute","onSameUrlNavigation","err","console","log","selectors","inputs","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/Users/andrewhughes/Desktop/project3/e-commerce-frontend-angular/src/app/components/product-card/product-card.component.html","/Users/andrewhughes/Desktop/project3/e-commerce-frontend-angular/src/app/components/product-card/product-card.component.ts"],"sourcesContent":["<div class=\"card\" style=\"width: 18rem\">\n  <img class=\"card-img-top\" style=\"cursor: pointer;\" [src]=\"productInfo.image\" (click)=\"selectProduct()\"\n    alt=\"Card image cap\" />\n  <div class=\"card-body\" style=\"cursor: pointer;\" (click)=\"selectProduct()\">\n    <h5 class=\"card-title\">{{ productInfo.name }}</h5>\n    <div class=\"well\">\n      <p class=\"card-text \">{{ productInfo.description }}</p>\n      <h5 class=\"card-text\">${{ productInfo.price.toFixed(2) }}</h5>\n    </div>\n\n    <p class=\"card-text text-danger\">{{ msg }}</p>\n  </div>\n\n  <div class=\"container\">\n\n    <div class=\"input-group input-group-sm mb-3\">\n      <div class=\"input-group-prepend\">\n        <span class=\"input-group-text\" id=\"inputGroup-sizing-sm\">Quantity in Stock</span>\n      </div>\n      <input type=\"number\" class=\"form-control\" aria-label=\"Sizing example input\" [value]=\"productInfo.quantity\"\n        aria-describedby=\"inputGroup-sizing-sm\" disabled />\n    </div>\n    <div class=\"input-group input-group-sm mb-3\" *ngIf=\"authService.isAuthenticated$ | async\">\n      <div class=\"input-group-prepend\">\n        <span class=\"input-group-text\">Quantity Ordered</span>\n      </div>\n      <input id=\"qty{{ productInfo.id }}\" type=\"number\" class=\"form-control\" aria-label=\"Sizing example input\"\n        aria-describedby=\"inputGroup-sizing-sm\" min=\"1\" [value]=\"1\" />\n    </div>\n  </div>\n\n\n  <div *ngIf=\"role == 'ADMIN'\" class=\"wrapper text-center\">\n    <div class=\"card-body btn-group text-center\">\n\n      <button class=\"btn btn-outline-primary btn-sm\" (click)=\"updatePopUp(productInfo)\">\n        Update Item Info\n      </button>\n      <button class=\"btn btn-outline-danger btn-sm\" (click)=\"deletePopUp(productInfo)\">\n        Delete Product\n      </button>\n\n\n    </div>\n\n  </div>\n  <div class=\"card-body\">\n    <div class=\"container\">\n      <div *ngIf=\"authService.isAuthenticated$ | async\">\n        <button class=\"btn btn-outline-success btn-block text-center\" (click)=\"addToCart(productInfo)\">\n          Add to Cart\n        </button>\n      </div>\n    </div>\n  </div>\n\n\n</div>","import { DisplayProductsComponent } from './../../pages/display-products/display-products.component';\nimport { Product } from './../../models/product';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { Component, Input, OnInit } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { Router } from '@angular/router';\nimport { ProductService } from 'src/app/services/product.service';\nimport { AppComponent } from 'src/app/app.component';\nimport { User } from '../../models/user';\nimport { AuthenticationService } from 'src/app/services/authentication.service';\nimport { AuthService } from '@auth0/auth0-angular';\n\n@Component({\n  selector: 'app-product-card',\n  templateUrl: './product-card.component.html',\n  styleUrls: ['./product-card.component.css'],\n})\n\n/**\n * Create a product card for each product.\n * Also contains functions to add product to cart\n */\nexport class ProductCardComponent implements OnInit {\n  currentUserString: any = sessionStorage.getItem('user');\n  currentUser: User = JSON.parse(this.currentUserString);\n\n\n  wantToDelete: boolean = false;\n  wantToUpdate: boolean = false;\n  cartCount!: number;\n\n  // array of products\n  products: {\n    product: Product;\n    quantity: number;\n  }[] = [];\n\n  subscription!: Subscription;\n  totalPrice: number = 0;\n  msg: string = '';\n\n  modalVisibility: string = '';\n  role: string = this.authentication.role;\n\n\n\n  @Input() productInfo!: Product;\n  constructor(\n    public appcomponent: AppComponent,\n    private productService: ProductService,\n    private router: Router,\n\n    public authService: AuthService,\n    public disProdComp: DisplayProductsComponent,\n    private authentication: AuthenticationService\n\n\n  ) { }\n  ngOnInit(): void {\n    this.subscription = this.productService.getCart().subscribe((cart) => {\n      this.cartCount = cart.cartCount;\n      this.products = cart.products;\n      this.totalPrice = cart.totalPrice;\n    });\n  }\n\n  /**\n   * Adds Product to cart\n   * @param {Product} product\n   * @returns void\n   */\n  addToCart(product: Product): void {\n    let inCart = false;\n    let toBuy = Number(\n      (<HTMLInputElement>document.getElementById(`qty${product.id}`)).value\n    );\n    this.msg = '';\n\n    if (toBuy < 1) {\n      this.msg =\n        'Can not add a 0 or negitive number of items to order, please enter a higher order amount.';\n      return;\n    }\n\n    this.products.forEach((element) => {\n      if (element.product.id == product.id) {\n        if (toBuy + element.quantity > product.quantity) {\n          this.msg =\n            'Can not order more items then currently in stock, please enter a lower order amount.';\n          inCart = true;\n        }\n        else {\n          element.quantity += toBuy;\n          let cart = {\n            cartCount: this.cartCount + toBuy,\n            products: this.products,\n            totalPrice: this.totalPrice + (toBuy * this.productInfo.price),\n          };\n\n          this.productService.setCart(cart);\n          inCart = true;\n          return;\n        }\n      }\n    });\n\n    if (!inCart) {\n      if (toBuy > product.quantity) {\n        this.msg =\n          'Can not order more items then currently in stock, please enter a lower order amount';\n        return;\n      }\n\n      let newProduct = {\n        product: product,\n        quantity: toBuy,\n      };\n      this.products.push(newProduct);\n      let cart = {\n        cartCount: this.cartCount + toBuy,\n        products: this.products,\n        totalPrice: this.totalPrice + product.price * toBuy,\n      };\n      this.productService.setCart(cart);\n    }\n  }\n\n  /**\n   * Sets Product in Session storage. Redirects user to /product-details\n   */\n  selectProduct(): void {\n    sessionStorage.setItem('selectedProductId', this.productInfo.id.toString());\n    this.router.navigate(['/product-details']);\n  }\n\n  ngOnDestroy() {\n    this.subscription.unsubscribe();\n  }\n\n  /** \n   * Updates popup with \n   * @param {Product} product\n  */\n  updatePopUp(product: Product) {\n    this.disProdComp.productToUpdate.id = product.id;\n    this.disProdComp.productToUpdate.name = product.name;\n    this.disProdComp.productToUpdate.quantity = product.quantity;\n    this.disProdComp.productToUpdate.price = product.price;\n    this.disProdComp.productToUpdate.image = product.image;\n    this.disProdComp.productToUpdate.description = product.description;\n    this.disProdComp.updateModalVisibility = 'block';\n  }\n\n  /**\n   * Removes Popup\n   * @param product \n   */\n  deletePopUp(product: Product) {\n    this.disProdComp.productToDelete.id = product.id;\n    this.disProdComp.deleteModalVisibility = 'block';\n  }\n  wantsToDelete() {\n    this.wantToDelete = !this.wantToDelete;\n  }\n\n  /**\n   * Removes Product and reroutes to /\n   * @param product \n   */\n  onDeleteProduct(product: Product) {\n    this.productService.deleteProduct(product.id).subscribe(\n      () => {\n        this.router.routeReuseStrategy.shouldReuseRoute = () => false;\n        this.router.onSameUrlNavigation = 'reload';\n\n        this.router.navigate(['/']);\n      },\n      (err: any) => console.log(err),\n    );\n  }\n\n}\n\n"]},"metadata":{},"sourceType":"module"}