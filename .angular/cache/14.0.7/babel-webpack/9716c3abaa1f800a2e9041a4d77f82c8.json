{"ast":null,"code":"import { Product } from 'src/app/models/product';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./../../services/product.service\";\nimport * as i2 from \"./../../services/review.service\";\nimport * as i3 from \"@auth0/auth0-angular\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../components/navbar/navbar.component\";\nimport * as i6 from \"../../components/review-submit/review-submit.component\";\nimport * as i7 from \"../../components/review/review.component\";\n\nfunction ProductDetailsComponent_button_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ProductDetailsComponent_button_22_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.addToCart(ctx_r3.productDetail));\n    });\n    i0.ɵɵtext(1, \" Add to Cart \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ProductDetailsComponent_p_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 17);\n    i0.ɵɵtext(1, \"No reviews for this product yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ProductDetailsComponent_app_review_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-review\", 18);\n  }\n\n  if (rf & 2) {\n    const review_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"reviewObj\", review_r5);\n  }\n}\n\nexport class ProductDetailsComponent {\n  constructor(productService, reviewService, auth) {\n    this.productService = productService;\n    this.reviewService = reviewService;\n    this.auth = auth;\n    this.productId = sessionStorage.getItem('selectedProductId');\n    this.productDetail = new Product(0, '', 0, '', 0, '');\n    this.products = [];\n    this.reviews = [];\n    this.totalPrice = 0;\n    this.userId = Number(sessionStorage.getItem('userId'));\n  }\n\n  ngOnInit() {\n    this.productService.getSingleProduct(this.productId).subscribe(response => this.productDetail = response, err => {\n      console.log(err);\n    });\n    this.subscription = this.productService.getCart().subscribe(cart => {\n      this.cartCount = cart.cartCount;\n      this.products = cart.products;\n      this.totalPrice = cart.totalPrice;\n    });\n    this.reviewService.getProductReviews(this.productId).subscribe(response => {\n      this.reviews = response;\n      let userReviewArray = this.reviews.filter(review => {\n        return review.user.id === this.userId;\n      });\n      this.userReview = userReviewArray.length > 0 ? userReviewArray[0] : null;\n    });\n  }\n\n  addToCart(product) {\n    let inCart = false;\n    this.products.forEach(element => {\n      if (element.product == product) {\n        ++element.quantity;\n        let cart = {\n          cartCount: this.cartCount + 1,\n          products: this.products,\n          totalPrice: this.totalPrice + product.price\n        };\n        this.productService.setCart(cart);\n        inCart = true;\n        return;\n      }\n    });\n\n    if (!inCart) {\n      let newProduct = {\n        product: product,\n        quantity: 1\n      };\n      this.products.push(newProduct);\n      let cart = {\n        cartCount: this.cartCount + 1,\n        products: this.products,\n        totalPrice: this.totalPrice + product.price\n      };\n      this.productService.setCart(cart);\n    }\n  }\n\n}\n\nProductDetailsComponent.ɵfac = function ProductDetailsComponent_Factory(t) {\n  return new (t || ProductDetailsComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.ReviewService), i0.ɵɵdirectiveInject(i3.AuthService));\n};\n\nProductDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ProductDetailsComponent,\n  selectors: [[\"app-product-details\"]],\n  inputs: {\n    productInfo: \"productInfo\"\n  },\n  decls: 32,\n  vars: 12,\n  consts: [[1, \"container\"], [1, \"product-grid\"], [1, \"well\"], [\"alt\", \"\", 1, \"img-fluid\", 3, \"src\"], [1, \"card\", \"product-card\"], [1, \"card-heading\"], [1, \"well\", \"align-items-end\", 2, \"margin-left\", \"5%\"], [1, \"card-body\"], [1, \"font-weight-bold\"], [\"class\", \"btn btn-outline-success\", 3, \"click\", 4, \"ngIf\"], [1, \"container\", \"justify-content-center\", \"mt-5\"], [1, \"text-center\", \"mt-2\"], [1, \"justify-content-center\", \"text-center\", \"mb-2\"], [\"class\", \"text-muted text-center\", 4, \"ngIf\"], [3, \"productId\", \"isReviewed\"], [3, \"reviewObj\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-outline-success\", 3, \"click\"], [1, \"text-muted\", \"text-center\"], [3, \"reviewObj\"]],\n  template: function ProductDetailsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-navbar\");\n      i0.ɵɵelementStart(1, \"div\", 0)(2, \"div\", 1)(3, \"div\", 2);\n      i0.ɵɵelement(4, \"img\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 4)(6, \"div\", 5)(7, \"div\", 2)(8, \"h1\");\n      i0.ɵɵtext(9);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(10, \"div\", 6)(11, \"h3\");\n      i0.ɵɵtext(12);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(13, \"div\", 7)(14, \"div\", 2)(15, \"p\", 8);\n      i0.ɵɵtext(16, \"Description\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"p\");\n      i0.ɵɵtext(18);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(19, \"div\", 2)(20, \"p\");\n      i0.ɵɵtext(21);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(22, ProductDetailsComponent_button_22_Template, 2, 0, \"button\", 9);\n      i0.ɵɵpipe(23, \"async\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(24, \"div\", 10)(25, \"div\", 11)(26, \"h3\", 8);\n      i0.ɵɵtext(27, \"Product Reviews\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(28, \"div\", 12);\n      i0.ɵɵtemplate(29, ProductDetailsComponent_p_29_Template, 2, 0, \"p\", 13);\n      i0.ɵɵelement(30, \"app-review-submit\", 14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(31, ProductDetailsComponent_app_review_31_Template, 1, 1, \"app-review\", 15);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"src\", ctx.productDetail.image, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate(ctx.productDetail.name);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\"$\", ctx.productDetail.price.toFixed(2), \"\");\n      i0.ɵɵadvance(6);\n      i0.ɵɵtextInterpolate1(\" \", ctx.productDetail.description, \"\");\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\"Quantity in Stock: \", ctx.productDetail.quantity, \"\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(23, 10, ctx.auth.isAuthenticated$));\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.reviews.length == 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"productId\", ctx.productId)(\"isReviewed\", ctx.userReview !== null);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.reviews);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i5.NavbarComponent, i6.ReviewSubmitComponent, i7.ReviewComponent, i4.AsyncPipe],\n  styles: [\".center[_ngcontent-%COMP%] {\\n  margin-left: auto;\\n  margin-right: auto;\\n}\\n\\n.product-card[_ngcontent-%COMP%]{\\n  border-radius: 2em;\\n  width: 50em;\\n  box-shadow: 0 5px 10px rgba(0,0,0,.2);\\n}\\n\\n#product-img[_ngcontent-%COMP%]{\\n  border: 3px solid #0000;\\n  padding: 0;\\n}\\n\\n.well[_ngcontent-%COMP%]{\\n  margin-left: 3%;\\n  margin-top: 1%;\\n}\\n\\n.product-grid[_ngcontent-%COMP%]{\\n  display:grid;\\n  grid-template-columns: 1fr 2fr;\\n  gap: 5%;\\n  place-items: center;\\n  margin-top: 5%;\\n}\\n\\n.review[_ngcontent-%COMP%]{\\n  border-bottom: 1px orange;\\n  border-top: 2px orange;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2R1Y3QtZGV0YWlscy5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsaUJBQWlCO0VBQ2pCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gscUNBQXFDO0FBQ3ZDOztBQUNBO0VBQ0UsdUJBQXVCO0VBQ3ZCLFVBQVU7QUFDWjs7QUFFQTtFQUNFLGVBQWU7RUFDZixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsWUFBWTtFQUNaLDhCQUE4QjtFQUM5QixPQUFPO0VBQ1AsbUJBQW1CO0VBQ25CLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsc0JBQXNCO0FBQ3hCIiwiZmlsZSI6InByb2R1Y3QtZGV0YWlscy5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNlbnRlciB7XG4gIG1hcmdpbi1sZWZ0OiBhdXRvO1xuICBtYXJnaW4tcmlnaHQ6IGF1dG87XG59XG5cbi5wcm9kdWN0LWNhcmR7XG4gIGJvcmRlci1yYWRpdXM6IDJlbTtcbiAgd2lkdGg6IDUwZW07XG4gIGJveC1zaGFkb3c6IDAgNXB4IDEwcHggcmdiYSgwLDAsMCwuMik7XG59XG4jcHJvZHVjdC1pbWd7XG4gIGJvcmRlcjogM3B4IHNvbGlkICMwMDAwO1xuICBwYWRkaW5nOiAwO1xufVxuXG4ud2VsbHtcbiAgbWFyZ2luLWxlZnQ6IDMlO1xuICBtYXJnaW4tdG9wOiAxJTtcbn1cblxuLnByb2R1Y3QtZ3JpZHtcbiAgZGlzcGxheTpncmlkO1xuICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAyZnI7XG4gIGdhcDogNSU7XG4gIHBsYWNlLWl0ZW1zOiBjZW50ZXI7XG4gIG1hcmdpbi10b3A6IDUlO1xufVxuXG4ucmV2aWV3e1xuICBib3JkZXItYm90dG9tOiAxcHggb3JhbmdlO1xuICBib3JkZXItdG9wOiAycHggb3JhbmdlO1xufVxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["Product","i0","ProductDetailsComponent","constructor","productService","reviewService","auth","sessionStorage","getItem","Number","ngOnInit","getSingleProduct","productId","subscribe","response","productDetail","err","console","log","subscription","getCart","cart","cartCount","products","totalPrice","getProductReviews","reviews","userReviewArray","filter","review","user","id","userId","userReview","length","addToCart","product","inCart","forEach","element","quantity","price","setCart","newProduct","push","selectors","inputs","productInfo","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/Users/andrewhughes/Desktop/project3/e-commerce-frontend-angular/src/app/pages/product-details/product-details.component.ts","/Users/andrewhughes/Desktop/project3/e-commerce-frontend-angular/src/app/pages/product-details/product-details.component.html"],"sourcesContent":["import { ReviewService } from './../../services/review.service';\nimport { ProductService } from './../../services/product.service';\nimport { Subscription } from 'rxjs';\nimport { Component, Input, OnInit } from '@angular/core';\nimport { Product } from 'src/app/models/product';\nimport {AuthService} from \"@auth0/auth0-angular\";\n\n@Component({\n  selector: 'app-product-details',\n  templateUrl: './product-details.component.html',\n  styleUrls: ['./product-details.component.css'],\n})\nexport class ProductDetailsComponent implements OnInit {\n  productId: number = sessionStorage.getItem(\n    'selectedProductId'\n  ) as unknown as number;\n  productDetail: Product = new Product(0, '', 0, '', 0, '');\n\n  cartCount!: number;\n  products: {\n    product: Product;\n    quantity: number;\n  }[] = [];\n  reviews: any = [];\n  subscription!: Subscription;\n  totalPrice: number = 0;\n  userReview: any;\n  userId: number = Number(sessionStorage.getItem('userId'));\n\n  @Input() productInfo!: Product;\n\n  constructor(\n    private productService: ProductService,\n    private reviewService: ReviewService,\n    public auth:AuthService\n  ) {}\n\n  ngOnInit(): void {\n    this.productService.getSingleProduct(this.productId).subscribe(\n      (response) => (this.productDetail = response),\n      (err) => {\n        console.log(err);\n      }\n    );\n\n    this.subscription = this.productService.getCart().subscribe((cart) => {\n      this.cartCount = cart.cartCount;\n      this.products = cart.products;\n      this.totalPrice = cart.totalPrice;\n    });\n\n    this.reviewService\n      .getProductReviews(this.productId)\n      .subscribe((response) => {\n        this.reviews = response;\n        let userReviewArray = this.reviews.filter((review: any) => {\n          return review.user.id === this.userId;\n        });\n        this.userReview =\n          userReviewArray.length > 0 ? userReviewArray[0] : null;\n      });\n  }\n\n  addToCart(product: Product): void {\n    let inCart = false;\n\n    this.products.forEach((element) => {\n      if (element.product == product) {\n        ++element.quantity;\n        let cart = {\n          cartCount: this.cartCount + 1,\n          products: this.products,\n          totalPrice: this.totalPrice + product.price,\n        };\n        this.productService.setCart(cart);\n        inCart = true;\n        return;\n      }\n    });\n\n    if (!inCart) {\n      let newProduct = {\n        product: product,\n        quantity: 1,\n      };\n      this.products.push(newProduct);\n      let cart = {\n        cartCount: this.cartCount + 1,\n        products: this.products,\n        totalPrice: this.totalPrice + product.price,\n      };\n      this.productService.setCart(cart);\n    }\n  }\n}\n","<app-navbar></app-navbar>\n<div class=\"container\">\n  <div class=\"product-grid\">\n    <div class=\"well\">\n      <img [src]=\"productDetail.image\" alt=\"\" class=\"img-fluid\" />\n    </div>\n    <div class=\"card product-card\">\n      <div class=\"card-heading\">\n        <div class=\"well\">\n          <h1>{{ productDetail.name }}</h1>\n        </div>\n\n      </div>\n      <div class=\"well align-items-end\" style=\"margin-left:5%\">\n        <h3>${{ productDetail.price.toFixed(2) }}</h3>\n      </div>\n      <div class=\"card-body\">\n\n      <div class=\"well\">\n        <p class=\"font-weight-bold\">Description</p>\n        <p> {{ productDetail.description }}</p>\n      </div>\n      <div class=\"well\">\n        <p>Quantity in Stock: {{productDetail.quantity}}</p>\n        <button class=\"btn btn-outline-success\" (click)=\"addToCart(productDetail)\" *ngIf=\"auth.isAuthenticated$ | async\">\n          Add to Cart\n        </button>\n      </div>\n      </div>\n    </div>\n\n    </div>\n  </div>\n\n\n<div class=\"container justify-content-center mt-5\">\n  <div class=\"text-center mt-2\">\n    <h3 class=\"font-weight-bold\">Product Reviews</h3>\n  </div>\n  <div class=\"justify-content-center text-center mb-2\">\n    <p *ngIf=\"reviews.length == 0\" class=\"text-muted text-center\">No reviews for this product yet.</p>\n  <app-review-submit [productId]=\"productId\" [isReviewed]=\"userReview !== null\"></app-review-submit>\n  </div>\n\n  <app-review *ngFor=\"let review of reviews\" [reviewObj]=\"review\"></app-review>\n</div>\n\n\n"]},"metadata":{},"sourceType":"module"}